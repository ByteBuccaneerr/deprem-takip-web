<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Son Depremler</title>
    <link rel="icon" type="image/x-icon" href="deprem_favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f4f6f8;
            margin: 0;
            padding: 20px;
            transition: background 0.5s, color 0.5s;
        }
        .container {
            max-width: 900px;
            margin: auto;
            text-align: center;
        }
        h1.site-title {
            color: #34495e;
            font-size: 2.4rem;
            margin-bottom: 20px;
            transition: color 0.5s;
        }
        .btn, select, label {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 30px;
            background: #3498db;
            color: white;
            font-size: 15px;
            cursor: pointer;
            transition: transform 0.2s, background 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn:hover {
            background: #2980b9;
            transform: scale(1.05);
        }
        select {
            background: #2980b9;
            appearance: none;
        }
        .earthquake {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-left: 5px solid #27ae60;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            cursor: pointer;
            text-align: left;
        }
        .earthquake:hover {
            transform: translateY(-3px);
        }
        .dark-mode {
            background: #2c3e50;
            color: #ecf0f1;
        }
        .dark-mode .earthquake {
            background: #34495e;
            color: #ecf0f1;
        }
        .dark-mode .btn, .dark-mode select, .dark-mode label {
            background: #7f8c8d;
            color: #2c3e50;
        }
        .dark-mode h1.site-title {
            color: #ecf0f1;
        }
        .dark-mode #topBtn {
            background: #7f8c8d;
             color: #2c3e50;
        }
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 95%;
        }
        .dark-mode .modal {
            background: #3b4a5a;
            color: #ecf0f1;
        }
        #topBtn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: none;
            background: #2980b9;
        }
        #map {
            width: 100%;
            height: 300px;
            margin-top: 15px;
            border-radius: 10px;
        }
        footer {
            margin-top: 30px;
            font-size: 12px;
            color: gray;
            text-align: center;
        }
        a {
            color: #2980b9;
            text-decoration: none;
        }
        @media (max-width: 600px) {
            .btn, select, label {
                width: 90%;
                font-size: 14px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="site-title"><i class="fas fa-wave-square"></i> Son Depremler</h1>
        <button class="btn" onclick="loadData()"><i class="fas fa-sync-alt"></i> Yenile</button>
        <button class="btn" onclick="toggleDarkMode()"><i class="fas fa-moon"></i> Tema</button>
        <label class="btn"><input type="checkbox" id="filterCheckbox" onchange="loadData()"> 4.0+ G√∂ster</label>
        <select id="dateFilter" onchange="loadData()">
            <option value="all">T√ºm Zamanlar</option>
            <option value="24">Son 24 Saat</option>
            <option value="72">Son 3 G√ºn</option>
        </select>
        <select id="favFilter" onchange="loadData()">
            <option value="all">T√ºm B√∂lgeler</option>
        </select>
        <div id="earthquake-list">Veriler y√ºkleniyor...</div>
        <button class="btn" onclick="scrollToTop()" id="topBtn"><i class="fas fa-arrow-up"></i> Ba≈üa D√∂n</button>
    </div>

    <div id="modal" class="modal"></div>
    <button class="btn" onclick="showInfo()" style="position:fixed; top:10px; right:10px; z-index:1001;"><i class="fas fa-info-circle"></i> Bilgi</button>

    <div id="infoModal" class="modal">
        <p><strong>‚ö†Ô∏è Bilgilendirme:</strong><br><br>
        Bu web sitesi, <b>hi√ßbir ticari ama√ß g√ºtmeden</b>, sadece g√ºncel depremlere kolay eri≈üim saƒülamak amacƒ±yla hazƒ±rlanmƒ±≈ütƒ±r.<br><br>
        G√∂sterilen veriler <b>Kandilli Rasathanesi</b> kaynaklƒ±dƒ±r ve doƒüruluklarƒ± garanti edilmez.<br><br>
        Web sitesi resmi bir kurum deƒüildir ve <b>herhangi bir sorumluluk kabul etmez</b>.<br><br>
        G√ºncel bilgiler i√ßin yetkili kurumlarƒ±n a√ßƒ±klamalarƒ±nƒ± takip ediniz.</p>
        <button class="btn" onclick="closeInfo()">Kapat</button>
    </div>

    <footer>
        ‚ö†Ô∏è Bu web sitesi hi√ßbir ticari ama√ß g√ºtmeden hazƒ±rlanmƒ±≈ütƒ±r. G√∂sterilen veriler Kandilli Rasathanesi kaynaklƒ±dƒ±r ve doƒüruluklarƒ± garanti edilmez.
    </footer>

    <audio id="alertSound">
        <source src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" type="audio/ogg">
    </audio>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        let favCities = [];

        function loadData() {
            const apiUrl = "https://api.orhanaydogdu.com.tr/deprem/kandilli/live";
            const filterEnabled = document.getElementById('filterCheckbox').checked;
            const dateFilter = document.getElementById('dateFilter').value;
            const favFilter = document.getElementById('favFilter').value;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const listDiv = document.getElementById('earthquake-list');
                    listDiv.innerHTML = "";
                    favCities = [];

                    data.result.slice(0, 100).forEach(eq => {
                        if (filterEnabled && eq.mag < 4) return;
                        const eqDate = new Date(eq.date);
                        const now = new Date();
                        const diffHours = (now - eqDate) / 36e5;
                        if (dateFilter !== "all" && diffHours > parseInt(dateFilter)) return;
                        if (favFilter !== "all" && !eq.title.includes(favFilter)) return;

                        let color = '#2ecc71';
                        if (eq.mag >= 4) color = '#e67e22';
                        if (eq.mag >= 5) color = '#e74c3c';

                        const eqDiv = document.createElement('div');
                        eqDiv.className = 'earthquake';
                        eqDiv.style.borderLeft = `5px solid ${color}`;
                        eqDiv.innerHTML = `<strong>${eq.title}</strong><br>üìÖ ${eq.date} | üåã ${eq.mag} ML | üìè ${eq.depth} km`;
                        eqDiv.onclick = () => showMap(eq);
                        listDiv.appendChild(eqDiv);

                        if (eq.mag >= 5) document.getElementById('alertSound').play();
                        favCities.push(eq.title.split(' ')[0]);
                    });
                    updateFavFilter();
                });
        }

        function showMap(eq) {
            const modal = document.getElementById('modal');
            modal.style.display = 'block';
            modal.innerHTML = `
                <h3>${eq.title}</h3>
                <p><strong>Tarih:</strong> ${eq.date}</p>
                <p><strong>B√ºy√ºkl√ºk:</strong> ${eq.mag} ML</p>
                <p><strong>Derinlik:</strong> ${eq.depth} km</p>
                <div id="map"></div>
                <button class="btn" onclick="closeModal()">Kapat</button>
            `;
            const coords = eq.geojson.coordinates;
            const map = L.map('map').setView([coords[1], coords[0]], 7);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            L.marker([coords[1], coords[0]]).addTo(map).bindPopup(`${eq.title}<br>B√ºy√ºkl√ºk: ${eq.mag}`).openPopup();
            L.circle([coords[1], coords[0]], { color: 'red', fillColor: '#f03', fillOpacity: 0.3, radius: eq.mag * 10000 }).addTo(map);
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        function updateFavFilter() {
            const select = document.getElementById('favFilter');
            const uniqueCities = [...new Set(favCities)];
            select.innerHTML = '<option value="all">T√ºm B√∂lgeler</option>';
            uniqueCities.forEach(city => {
                select.innerHTML += `<option value="${city}">${city}</option>`;
            });
        }

        function showInfo() {
            document.getElementById('infoModal').style.display = 'block';
        }

        function closeInfo() {
            document.getElementById('infoModal').style.display = 'none';
        }

        window.onscroll = function() {
    const btn = document.getElementById('topBtn');
    if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
        btn.style.display = "block";
    } else {
        btn.style.display = "none";
    }
};


        window.onload = function() {
            showInfo();
            loadData();
        };
    </script>
</body>
</html>
